<mat-card>
  <mat-card-title>Titano Monthly Revenue Calculator</mat-card-title>
  <mat-card-subtitle>Helps you estimate monthly/weekly profit taking, in a sustainable way</mat-card-subtitle>
  <mat-card-content>
    <div class="small-chips-main">
      <div>
        <label>I would like to take profit for <input [(ngModel)]="desiredPeriodicWithdraw" type="number"
                                                      min="0"/></label>
        <mat-select [(value)]="currency" (selectionChange)="fetchQuote()">
          <mat-option *ngFor="let c of currencies" [value]="c">{{c.symbol}}</mat-option>
        </mat-select>
        every
      </div>
      <div style="display: flex" class="small-chips">
        <mat-chip-list aria-label="Select withdrawal period">
          <mat-chip color="primary"
                    [selected]="monthlyWithdrawal"
                    (click)="monthlyWithdrawal = !monthlyWithdrawal">month
          </mat-chip>
          <mat-chip color="primary"
                    [selected]="!monthlyWithdrawal"
                    (click)="monthlyWithdrawal = !monthlyWithdrawal">week
          </mat-chip>
        </mat-chip-list>
      </div>
      .
    </div>
    <label>
      My wallet contains <input [(ngModel)]="initialTitanoCapital" type="number" min="0"/>
    </label>
    <label>
      Titano, with current price of <input [(ngModel)]="titanoPrice" type="number" min="0"/> {{this.currency.symbol}}
      /Titano, and
    </label>
    <label>
      I assume slippage fees of <input [(ngModel)]="slippageFees" type="number" min="0" max="100"/>(%).
    </label>
    <mat-checkbox class="example-margin"
                  [(ngModel)]="taxesCalculationEnabled"
                  [color]="'primary'">
      Also include my Country's taxes
    </mat-checkbox>
    <label [class]="taxesCalculationEnabled ? 'enabled' : 'disabled'">, which amounts to
      <input [disabled]="!taxesCalculationEnabled" [(ngModel)]="taxesPercentage" type="number" min="0" max="100"/>(%)
      of the gross income.
    </label>

    <p></p>

    <mat-accordion>
      <mat-expansion-panel [expanded]="true">
        <mat-expansion-panel-header>
          <mat-panel-title>Analisys Result</mat-panel-title>
        </mat-expansion-panel-header>

        <p>
          As of today, with a wallet containing {{initialTitanoCapital}} Titano, if you want to
          withdraw {{desiredPeriodicWithdraw}} {{currency.symbol}}/{{monthlyWithdrawal ? "Month" : "Week"}}<b>{{taxesCalculationEnabled ? ' after taxes' : ''}}</b>,
          meaning {{periodicTitanoWithdrawal() | numberFormat}} Titano/{{monthlyWithdrawal ? "Month" : "Week"}} gross,
          you will need to wait until <b>{{firstWithdrawalDate() | date: dateFormat}}</b>, that is, <b>{{daysNeeded()}}
          days from today </b>.
        </p>
      </mat-expansion-panel>

      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>1Yr Profit and Wallet breakdown</mat-panel-title>
        </mat-expansion-panel-header>
        <div class="accordion-content">

          <!-- desktop view -->
          <div fxShow fxHide.lt-sm>
            <b>Ô∏èAssuming TITANO price won't change:</b>Ô∏è on {{dataSource[dataSource.length - 1].to | date: dateFormat}},
            by taking regular profits every {{monthlyWithdrawal ? 'month' : 'week'}}, you will have secured
            {{(monthlyWithdrawal ? 12 : 52) * desiredPeriodicWithdraw | numberFormat:0}} {{currency.symbol}}
            and, more importantly, <b>your TITANO wallet will keep increasing up
            to {{dataSource[dataSource.length - 1].finalAmount | scaleNumber}} TITANO</b>
            (~ {{dataSource[dataSource.length - 1].finalAmount * titanoPrice | scaleNumber}} {{currency.symbol}})!
            <div fxHide fxShow.lt-sm>Note: click on one row, to see the details of the corresponding period.</div>
          </div>
          <table mat-table [dataSource]="dataSource" fxShow fxHide.lt-sm>

            <ng-container matColumnDef="from" fxShow fxHide.lt-sm>
              <th mat-header-cell *matHeaderCellDef>From</th>
              <td mat-cell *matCellDef="let element">{{element.from | date: shortDateFormat}}</td>
            </ng-container>

            <ng-container matColumnDef="to">
              <th mat-header-cell *matHeaderCellDef>To</th>
              <td mat-cell *matCellDef="let row">{{row.to | date: shortDateFormat}}</td>
            </ng-container>

            <ng-container matColumnDef="initialAmount">
              <th mat-header-cell *matHeaderCellDef>TITANO</th>
              <td mat-cell *matCellDef="let row">{{row.initialAmount | scaleNumber}}</td>
            </ng-container>

            <ng-container matColumnDef="finalAmount">
              <th mat-header-cell *matHeaderCellDef>TITANO</th>
              <td mat-cell *matCellDef="let row">{{row.finalAmount | scaleNumber}}</td>
            </ng-container>

            <ng-container matColumnDef="value">
              <th mat-header-cell *matHeaderCellDef>Value ({{this.currency.symbol}})</th>
              <td mat-cell *matCellDef="let row">{{row.value | scaleNumber}}</td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

          <!-- mobile view -->
          <div fxHide fxShow.lt-sm>
            <b>Ô∏èAssuming TITANO price won't change:</b>Ô∏è on {{dataSource[dataSource.length - 1].to | date: dateFormat}}
            you will have withdraw
            {{(monthlyWithdrawal ? 12 : 52) * desiredPeriodicWithdraw | numberFormat:0}} {{currency.symbol}}
            and still have {{dataSource[dataSource.length - 1].finalAmount | scaleNumber}} TITANO
            (worth ~ {{dataSource[dataSource.length - 1].finalAmount * titanoPrice | scaleNumber}} {{currency.symbol}})!
            Note: click on the rows below to see the details.
          </div>
          <table mat-table [dataSource]="dataSource" multiTemplateDataRows fxHide fxShow.lt-sm>

            <ng-container matColumnDef="to">
              <th mat-header-cell *matHeaderCellDef>Date</th>
              <td mat-cell *matCellDef="let row">{{row.to | date: shortDateFormat}} </td>
            </ng-container>

            <ng-container matColumnDef="finalAmount">
              <th mat-header-cell *matHeaderCellDef>TITANO</th>
              <td mat-cell *matCellDef="let row">{{row.finalAmount | scaleNumber}} </td>
            </ng-container>

            <ng-container matColumnDef="value">
              <th mat-header-cell *matHeaderCellDef>Value ({{this.currency.symbol}})</th>
              <td mat-cell *matCellDef="let row">{{row.value | scaleNumber}} </td>
            </ng-container>

            <ng-container matColumnDef="expandedDetail">
              <td mat-cell *matCellDef="let row" [attr.colspan]="mobileColumns.length">
                <div class="row-detail"
                     [@detailExpand]="row == expandedElement ? 'expanded' : 'collapsed'">
                  During the period from {{row.from | date: shortDateFormat}} to {{row.to | date: shortDateFormat}} your
                  crypto wallet, after withdrawing {{desiredPeriodicWithdraw}}
                  {{currency.symbol}}/{{monthlyWithdrawal ? 'Month' : ' Week'}}, will
                  contain {{row.finalAmount | numberFormat}} TITANO, for a value
                  of {{row.finalAmount * titanoPrice | numberFormat}}{{currency.symbol}}.
                </div>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="mobileColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: mobileColumns;"
                class="mobile-row"
                [class.example-expanded-row]="newExpandedElement === row"
                (click)="expandedElement = newExpandedElement === row ? null : row">
            </tr>
            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="details-row"></tr>
          </table>
        </div>
      </mat-expansion-panel>
    </mat-accordion>

    <p></p>
    <p>
      ‚ö†Ô∏èNOTE‚ö†Ô∏è This site isn't affiliated in any way with TITANO.finance. Predictions presented here are not
      financial advice, and you must do your own due diligence before investing in any asset.
    </p>
  </mat-card-content>

  <mat-card-actions>
    <button mat-raised-button color="primary" (click)="openHowItWorksDialog()">HOW IT WORKS</button>
    <button mat-raised-button color="primary" (click)="openBuyMeABeerDialog()">BUY ME A BEERüç∫</button>
  </mat-card-actions>
</mat-card>

